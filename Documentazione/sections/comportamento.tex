\section{Front-end}
Gli scripts introdotti per la parte front-end, interamente sviluppata in \textbf{JavaScript}, offrono funzionalità che permettono una migliore esperienza per l'utente.


Nello specifico sono state inserite le seguenti features:
\begin {itemize}
\item un cookie per il salvataggio del nome utente al momento della pubblicazione di un nuovo commento
\item il placeholder nella barra di ricerca località
\item uno script relativo ai commenti utente che si occupa di controllare, caricare e nascondere i dati inseriti nella form di pubblicazione 
\item un modulo che effettua la geolocalizzazione 
\end {itemize} 
Per ogni caratteristica sopra elencata si è cercato di separare il codice nel modo più chiaro possibile; a tal fine si è scelto di utilizzare la libreria require.js (\textit{http://requirejs.org}) che si occupa essenzialmente di caricare files situati in percorsi diversi modularizzando quindi i vari scripts.


Require.js si è dimostrato un valido \textit{module loader} anche per la sua estesa compatibilità con i browsers ( IE 6+, Firefox 2+, Safari 3.2+, Chrome 3+, Opera 10+ ) .

\subsection{Gestione cookie}
Per immagazzinare persistentemente la username dell'utente abbiamo deciso di creare un cookie. 

Lo scopo di questo è velocizzare la compilazione di un commento infatti: l'utilizzatore, avendo pubblicato una prima volta, alla sua seconda troverà già riempito il campo nome utente.
 
Nei nostri scripts sono state implementate una funzione per l'inizializzazione ed una per il recupero/lettura del cookie appena creato.


In fase di creazione del cookie, oltre alla coppia chiave-valore abbiamo aggiunto come terzo parametro una data di scadenza impostata a 15 giorni.
La funzione di recupero restituisce il valore del cookie se questo è presente, successivamente il valore verrà inserito nel documento html e l'utente vedrà la username già compilata.

\subsection{ Inserimento placeholder in barra di ricerca}

Poichè il nostro progetto è conforme allo standard xhtml 1.0 strict ed  il tag \textit{placeholder} non vi è definito, abbiamo dovuto usare Javascript per riuscire nel nostro intento di includerlo.


Grazie ai metodi \textit{onblur} ed \textit{onfocus} abbiamo potuto forzare il valore di input della nostra barra di ricerca a seconda che questa si trovi in focus oppure no.


\subsection{Visualizzazione dei commenti (lato client)}

\subsection{Geolocalizzazione}
In questo progetto abbiamo inoltre deciso di implementare un modulo che fa uso delle API HTML5 per la geolocalizzazione. L'introduzione di tale caratteristica ha il puro scopo di migliorare la qualità del sito; in assenza di questa, l'utente avrà comunque accesso a tutte le funzionalità di base.
\begin{flushleft}
Grazie al modulo in questione, dopo aver acconsentito a fornire i dati sulla propria posizione e a seconda della pagina in cui si trova, all'utente verranno mostrate diverse informazioni.
\end{flushleft}

\begin{flushleft}
In particolare, spostandosi sulle pagine “mare.html”o “citta.html”oppure “montagna.html” verranno visualizzate:
\begin{itemize}
\item\textit{una mappa a livello stradale avente tanti marker quante sono le località recensite all'interno della sezione appena raggiunta ed il marker che segnala la posizione attuale;
\item una descrizione recante per ognuna delle località della sezione, la distanza in km dalla posizione attuale.}
\end{itemize}
\end{flushleft}
\begin{flushleft}
In alternativa, spostandosi sulle pagine delle località recensite (es: “praga.html”) verranno visualizzate:
\end{flushleft}
\begin{itemize}
\item\textit{una mappa a livello stradale ad un livello di zoom maggiore rispetto al precedente ed un solo marker posizionato nel centro della città considerata;
\item una piccola descrizione che informa sulla distanza tra la città considerata e la posizione attuale.}
\end{itemize}
È stato scelto di utilizzare Google Maps poiché gli utenti hanno una maggiore
familiarità con le mappe offerte da Google\footnote{ Fonte: comScore Mobile
Metrix, analisi effettuata negli Stati Uniti a Giugno 2014.}, per la qualità
della documentazione relativa alle API offerta da Google e perchè l'utente con
queste mappe riesce facilmente a spostarsi, aumentare il dettaglio di zoom
oppure passare in modalità StreetView in modo semplice ed immediato.

\subsubsection{L'implementazione del modulo in dettaglio}

Per svolgere più leggermente l'attività di codifica è stata inclusa una libreria di utilità, underscore.js (\textit{http://underscorejs.org}).
Vi è un unico script che viene inizializzato al caricamento della pagina ed è valido sia per le pagine di sezione, (es: “mare.html”) sia per le pagine delle località turistiche (es: “praga.html”).
Questo è stato possibile attraverso la ricerca di un id presente solamente nelle pagine relative alle categorie, ma assente nelle pagine delle località. In tal modo lo script è in grado di discriminare se la pagina è di una categoria o di una località.

\begin{flushleft}
Per ottenere i dati voluti abbiamo dovuto realizzare una base-dati con le informazioni delle località recensite attraverso un oggetto JavaScript così formato:
\end{flushleft}
\begin{verbatim}
   var località = {
       "Parigi": {
	          "name": "Parigi",
	          "loc":"Città",
	          "lat": 48.856614,
	          "lon":  2.3522219
       }
   }
\end{verbatim}
\begin{flushleft}
La funzione principale dalla quale estrapoliamo poi tutti i dati è \textit{getLocation()}.

Invocando questa funzione viene innanzitutto verificato se il browser supporta la geolocalizzazione, fornendo un messaggio di errore nel caso in cui non la supportasse; se invece il browser supporta questa funzionalità, viene chiamata la funzione \textit{navigator.geolocation.getCurrentPosition(showPosition}) la quale recupera latitudine e longitudine della posizione attuale del dispositivo utilizzato dall'utente.
\end{flushleft}
\begin{flushleft}
La funzione \textit{CalcolaDistanza(mylat,mylon,lat,lon)}, come dice il nome, si occupa di calcolare la distanza fra 2 coordinate geografiche; essa prende come argomenti latitudine e longitudine dei due punti desiderati ed attraverso la formula dell'emisenoverso ne restituisce la distanza in km.
\end{flushleft}

\begin{flushleft}
La funzione \textit{showPosition(position)} ha lo scopo di creare l'interfaccia per i dati ed è infatti la funzione più corposa dello script; essa effettua :
\end{flushleft}
\begin{itemize}
\item l'inizializzazione e successivamente la collocazione  della mappa con i marker nel documento HTML;
\item il filtraggio delle sole località da considerare;
\item il riordinamento per distanza minore dalla posizione attuale delle località nelle pagine di sezione;
\item la creazione e la collocazione degli elementi html che costituiscono le informazioni di distanza.
\end{itemize}

\begin{flushleft}
La funzionalità di geolocalizzazione offerta da \textit{What To Visit} è stata testata con i browser Google-Chrome ver.40+, Firefox ver.35+ sia in versione desktop che mobile.
\end{flushleft}



















